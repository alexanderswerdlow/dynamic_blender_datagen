from pathlib import Path
import os
import sys
import subprocess

DATA_DIR = Path.home() / "data" / "point_odyssey" / "data"
if DATA_DIR.exists() is False:
    DATA_DIR = Path("data")

DATA_DIR = Path(os.getenv("DATA_DIR", DATA_DIR))

def run_command(command):
    print(f"Running command: {command}")
    error_keywords = ("Error: Python: Traceback", "Error: Error")
    error_detected = False
    with subprocess.Popen(command, stdout=subprocess.PIPE, stderr=subprocess.STDOUT, shell=True) as proc:
        with os.fdopen(sys.stdout.fileno(), 'wb', closefd=False) as stdout:
            for line in proc.stdout:
                stdout.write(line)
                stdout.flush()
                if any(keyword in line.decode('utf-8') for keyword in error_keywords):
                    error_detected = True

        return_code = proc.wait()
        if return_code != 0:
            raise Exception(f"Command failed: {command}")
        
    if error_detected:
        raise Exception(f"Command failed: {command}")
        
urban_scenes = [
    'abandoned_bakery', 'abandoned_construction', 'abandoned_factory_canteen_01', 'abandoned_factory_canteen_02', 'abandoned_games_room_01', 'abandoned_games_room_02', 'abandoned_greenhouse', 'abandoned_hall_01', 'abandoned_parking', 'abandoned_slipway', 'abandoned_tank_farm_01', 'abandoned_tank_farm_02', 'abandoned_tank_farm_03', 'abandoned_tiled_room', 'abandoned_workshop', 'abandoned_workshop_02', 'acoustical_shell', 'adams_place_bridge', 'aerodynamics_workshop', 'aft_lounge', 'aircraft_workshop_01', 'altanka', 'amphitheatre_zanzibar_fort', 'anniversary_lounge', 'art_studio', 'artist_workshop', 'auto_service', 'autoshop_01', 'aviation_museum', 'balcony', 'ballroom', 'bank_vault', 'basement_boxing_ring', 'bathroom', 'beach_cloudy_bridge', 'beach_parking', 'belvedere', 'bethnal_green_entrance', 'between_bridges', 'binnenalster', 'birbeck_street_underpass', 'blaubeuren_church_square', 'blaubeuren_night', 'blender_institute', 'blinds', 'blocky_photo_studio', 'blue_lagoon', 'blue_lagoon_night', 'blue_photo_studio', 'boiler_room', 'brown_photostudio_01', 'brown_photostudio_02', 'brown_photostudio_03', 'brown_photostudio_04', 'brown_photostudio_05', 'brown_photostudio_06', 'brown_photostudio_07', 'buikslotermeerplein', 'burnt_warehouse', 'bush_restaurant', 'cabin', 'cambridge', 'canary_wharf', 'carpentry_shop_01', 'carpentry_shop_02', 'castel_st_angelo_roof', 'castle_zavelstein_cellar', 'cayley_interior', 'cedar_bridge', 'chapel_day', 'childrens_hospital', 'christmas_photo_studio_01', 'christmas_photo_studio_02', 'christmas_photo_studio_03', 'christmas_photo_studio_04', 'christmas_photo_studio_05', 'christmas_photo_studio_06', 'christmas_photo_studio_07', 'cinema_hall', 'cinema_lobby', 'circus_arena', 'cloudy_cliffside_road', 'cobblestone_street_night', 'colorful_studio', 'colosseum', 'combination_room', 'comfy_cafe', 'concrete_tunnel', 'concrete_tunnel_02', 'construction_yard', 'country_club', 'courtyard', 'courtyard_night', 'crosswalk', 'cyclorama_hard_light', 'dam_bridge', 'dancing_hall', 'de_balie', 'decor_shop', 'derelict_overpass', 'derelict_underpass', 'distribution_board', 'drachenfels_cellar', 'dresden_square', 'dresden_station_night', 'driving_school', 'dusseldorf_bridge', 'empty_warehouse_01', 'empty_workshop', 'en_suite', 'entrance_hall', 'factory_yard', 'fireplace', 'floral_tent', 'freight_station', 'furry_clouds', 'future_parking', 'garage', 'gear_store', 'georgentor', 'glass_passage', 'golden_bay', 'graffiti_shelter', 'gym_01', 'gym_entrance', 'hall_of_finfish', 'hall_of_mammals', 'hamburg_canal', 'hamburg_hbf', 'hangar_interior', 'hanger_exterior_cloudy', 'hansaplatz', 'hayloft', 'hospital_room', 'hospital_room_2', 'hotel_rooftop_balcony', 'hotel_room', 'indoor_pool', 'industrial_pipe_and_valve_01', 'industrial_pipe_and_valve_02', 'industrial_workshop_foundry', 'interior_construction', 'kart_club', 'kiara_interior', 'killesberg_park', 'konigsallee', 'konzerthaus', 'lake_pier', 'lapa', 'large_corridor', 'laufenurg_church', 'leadenhall_market', 'learner_park', 'lebombo', 'limehouse', 'little_paris_under_tower', 'lookout', 'lot_02', 'lythwood_lounge', 'lythwood_room', 'machine_shop_01', 'machine_shop_02', 'machine_shop_03', 'mall_parking_lot', 'marry_hall', 'medieval_cafe', 'metro_noord', 'metro_vijzelgracht', 'missile_launch_facility_01', 'modern_buildings', 'modern_buildings_2', 'modern_buildings_night', 'mosaic_tunnel', 'museum_of_ethnography', 'museum_of_history', 'museumplein', 'music_hall_01', 'music_hall_02', 'mutianyu', 'neon_photostudio', 'netball_court', 'neuer_zollhof', 'night_bridge', 'northcliff', 'old_apartments_walkway', 'old_bus_depot', 'old_depot', 'old_hall', 'old_outdoor_theater', 'old_room', 'orlando_stadium', 'outdoor_umbrellas', 'palermo_park', 'palermo_sidewalk', 'palermo_square', 'parking_garage', 'paul_lobe_haus', 'pedestrian_overpass', 'peppermint_powerplant', 'peppermint_powerplant_2', 'phone_shop', 'photo_studio_01', 'photo_studio_broadway_hall', 'photo_studio_loft_hall', 'photo_studio_london_hall', 'piazza_bologni', 'piazza_martin_lutero', 'piazza_san_marco', 'pillars', 'pine_attic', 'poly_haven_studio', 'pond_bridge_night', 'pool', 'portland_landing_pad', 'potsdamer_platz', 'preller_drive', 'pretville_cinema', 'pretville_street', 'provence_studio', 'pump_house', 'pump_station', 'pylons', 'quattro_canti', 'rathaus', 'reading_room', 'red_wall', 'reichstag_1', 'reinforced_concrete_01', 'reinforced_concrete_02', 'residential_garden', 'rhodes_memorial', 'roof_garden', 'roofless_ruins', 'rooftop_day', 'rooftop_night', 'rostock_arches', 'rostock_laage_airport', 'rotes_rathaus', 'round_platform', 'royal_esplanade', 'san_giuseppe_bridge', 'schadowplatz', 'school_hall', 'school_quad', 'sculpture_exhibition', 'sepulchral_chapel_basement', 'sepulchral_chapel_rotunda', 'shanghai_bund', 'shanghai_riverside', 'short_tunnel', 'signal_hill_dawn', 'signal_hill_sunrise', 'simons_town_harbour', 'skate_park', 'skidpan', 'skylit_garage', 'small_cathedral', 'small_cathedral_02', 'small_empty_house', 'small_empty_room_1', 'small_empty_room_2', 'small_empty_room_3', 'small_empty_room_4', 'small_hangar_01', 'small_hangar_02', 'small_workshop', 'snowy_cemetery', 'soliltude', 'solitude_interior', 'solitude_night', 'spree_bank', 'st_fagans_interior', 'st_peters_square_night', 'stadium_01', 'stone_alley', 'stone_alley_02', 'stone_alley_03', 'storeroom', 'street_lamp', 'studio_country_hall', 'studio_garden', 'studio_small_01', 'studio_small_02', 'studio_small_03', 'studio_small_04', 'studio_small_05', 'studio_small_06', 'studio_small_07', 'studio_small_08', 'studio_small_09', 'stuttgart_suburbs', 'suburban_parking_area', 'subway_entrance', 'summer_stage_01', 'summer_stage_02', 'sunset_jhbcentral', 'surgery', 'tears_of_steel_bridge', 'teatro_massimo', 'teufelsberg_ground_1', 'teufelsberg_ground_2', 'teufelsberg_inner', 'teufelsberg_lookout', 'teufelsberg_roof', 'thatch_chapel', 'the_sky_is_on_fire', 'theater_01', 'theater_02', 'tiber_1', 'tiber_2', 'tiber_island', 'trekker_monument', 'tv_studio', 'ulmer_muenster', 'under_bridge', 'unfinished_office', 'unfinished_office_night', 'urban_alley_01', 'urban_courtyard', 'urban_courtyard_02', 'urban_street_01', 'urban_street_02', 'urban_street_03', 'urban_street_04', 'vatican_road', 'venetian_crossroads', 'venice_dawn_1', 'venice_dawn_2', 'venice_sunrise', 'venice_sunset', 'veranda', 'vestibule', 'viale_giuseppe_garibaldi', 'vignaioli', 'vignaioli_night', 'vintage_measuring_lab', 'vulture_hide', 'whale_skeleton', 'wide_street_01', 'wide_street_02', 'winter_evening', 'wooden_lounge', 'wooden_motel', 'workshop', 'wrestling_gym', 'yaris_interior_garage', 'yoga_room', 'zavelstein', 'zhengyang_gate', 'zwinger_night'
]

validation_animals = ["tiger", "prisoner", "deer", "arissa", "zombie"]

validation_blender_scenes = [ "bedroom0210_egocentric.blend", "bedroom0210_human1.blend", "kg.blend", "kg_ego1.blend", "kg_ego2.blend", "scene_d78_3rd.blend", "scene_d78_ego1.blend", "scene_d78_ego2.blend" ]

validation_gso_objects = {"ASICS_HyperRocketgirl_SP_5_WhiteMalibu_BlueBlack", "Brisk_Iced_Tea_Lemon_12_12_fl_oz_355_ml_cans_144_fl_oz_426_lt", "Cole_Hardware_Electric_Pot_Assortment_55", "Diet_Pepsi_Soda_Cola12_Pack_12_oz_Cans", "Ecoforms_Planter_Pot_QP6Ebony", "FRUIT_VEGGIE_MEMO_GRADIENT", "Hilary", "Lalaloopsy_Peanut_Big_Top_Tricycle", "Melissa_Doug_Shape_Sorting_Clock", "MY_MOOD_MEMO", "Office_Depot_Canon_PGI22_Remanufactured_Ink_Cartridge_Black", "OXO_Soft_Works_Can_Opener_SnapLock", "Pet_Dophilus_powder", "Razer_Blackwidow_Tournament_Edition_Keyboard", "Reebok_ZIGLITE_RUSH", "Schleich_Therizinosaurus_ln9cruulPqc", "Sterilite_Caddy_Blue_Sky_17_58_x_12_58_x_9_14", "Tieks_Ballet_Flats_Diamond_White_Croc", "UGG_Classic_Tall_Womens_Boots_Chestnut_7", "Womens_Bluefish_2Eye_Boat_Shoe_in_White_Tumbled_YG44xIePRHw"}

validation_partnet_objects = {"10156", "10269", "10385", "10509", "10618", "10753", "10905", "11033", "1115", "1128", "11430", "11565", "11674", "11804", "1193", "12043", "12148", "1225", "12364", "12501", "12613", "12767", "12968", "13183", "13323", "13444", "1354", "13640", "13749", "13840", "13938", "14037", "14142", "14244", "14349", "14449", "14564", "14670", "14810", "14960", "1510", "15232", "15347", "15465", "15584", "15697", "1580", "15915", "16028", "16150", "16269", "16386", "16512", "16631", "16743", "16876", "16992", "17115", "17247", "17397", "1758", "17827", "18070", "18212", "18327", "1844", "18572", "18683", "18788", "18898", "19010", "19119", "1923", "1934", "19457", "19581", "19701", "19822", "19974", "20094", "20226", "20342", "2047", "20675", "20817", "20940", "21048", "21166", "21279", "21397", "2151", "21620", "21739", "21858", "21965", "221", "22205", "22320", "22433", "22565", "22670", "22784", "22911", "23029", "23143", "23279", "23471", "23651", "23769", "239", "24012", "24138", "24249", "24381", "24504", "24640", "24753", "24879", "24992", "25130", "25251", "25376", "25512", "25647", "25767", "25883", "26011", "26138", "26266", "26405", "26525", "26776", "26945", "27074", "27192", "2732", "27444", "27571", "27691", "27835", "27988", "28120", "2825", "28395", "28522", "2864", "28761", "28894", "29042", "29165", "29305", "29446", "2964", "2985", "30047", "30265", "30488", "30776", "30941", "31077", "3125", "31471", "31706", "32051", "32266", "32598", "32819", "32955", "33079", "3327", "33528", "3376", "3397", "34108", "34349", "34682", "3486", "3514", "35330", "35491", "35604", "35727", "35854", "3598", "36114", "36230", "36340", "36470", "36598", "36716", "36826", "36933", "3704", "37173", "37288", "37417", "37540", "37652", "37768", "3787", "37981", "38110", "38241", "38356", "3847", "38585", "38714", "38829", "38943", "39071", "39190", "39307", "39427", "39547", "39677", "39851", "39995", "40114", "40221", "40336", "40446", "40544", "40652", "40777", "40882", "41014", "41134", "41246", "41367", "41482", "41646", "41764", "41892", "41996", "4210", "42208", "42326", "42449", "42556", "42678", "42792", "42905", "43029", "43159", "43299", "43470", "43613", "43737", "43872", "44002", "44160", "44291", "44476", "44655", "44857", "44988", "45135", "45247", "45363", "45470", "456", "45698", "45821", "45943", "46067", "46188", "46340", "46491", "46620", "46769", "46893", "47057", "47198", "47354", "47542", "47666", "47873", "48002", "48156", "48314", "48467", "48640", "48790", "48996", "49139", "49317", "4995", "5100", "5209", "5319", "5425", "5520", "5624", "5723", "5822", "5918", "6019", "6122", "6226", "6328", "6432", "6543", "6649", "6748", "6851", "6949", "7072", "7167", "7268", "7368", "783", "8296", "8406", "8539", "8657", "8758", "885", "8967", "9083", "9200", "9379", "9510", "9659", "9787", "9946"}


sky_scenes = ['abandoned_parking', 'abandoned_pathway', 'abandoned_tank_farm_03', 'abandoned_tank_farm_04', 'abandoned_tank_farm_05', 'approaching_storm', 'aristea_wreck', 'aristea_wreck_puresky', 'autumn_field', 'autumn_field_puresky', 'autumn_park', 'aviation_museum_hill', 'beach_parking', 'belfast_sunset', 'belfast_sunset_puresky', 'bell_park_dawn', 'bell_park_pier', 'blouberg_sunrise_1', 'blouberg_sunrise_2', 'blue_lagoon', 'cannon', 'cape_hill', 'cayley_lookout', 'cedar_bridge', 'champagne_castle_1', 'circus_maximus_1', 'circus_maximus_2', 'citrus_orchard', 'citrus_orchard_road', 'clarens_midday', 'clarens_night_01', 'clarens_night_02', 'cloud_layers', 'delta_2', 'derelict_overpass', 'dirt_bike_track_01', 'drackenstein_quarry', 'drackenstein_quarry_puresky', 'drakensberg_solitary_mountain', 'drakensberg_solitary_mountain_puresky', 'dreifaltigkeitsberg', 'driving_school', 'dry_cracked_lake', 'dry_field', 'ehingen_hillside', 'ehingen_hillside_02', 'etzwihl', 'evening_field', 'evening_road_01', 'evening_road_01_puresky', 'farm_field', 'farm_field_puresky', 'farm_sunset', 'fish_hoek_beach', 'flower_road', 'fouriesburg_mountain_cloudy', 'fouriesburg_mountain_lookout', 'fouriesburg_mountain_lookout_2', 'fouriesburg_mountain_midday', 'freight_station', 'furry_clouds', 'green_point_park', 'harties', 'harvest', 'hilltop_construction', 'hilly_terrain_01', 'hilly_terrain_01_puresky', 'hochsal_field', 'industrial_sunset', 'industrial_sunset_02', 'industrial_sunset_02_puresky', 'industrial_sunset_puresky', 'je_gray_park', 'kiara_1_dawn', 'kiara_2_sunrise', 'kiara_3_morning', 'kiara_4_mid-morning', 'kiara_5_noon', 'kiara_6_afternoon', 'kiara_7_late-afternoon', 'kiara_8_sunset', 'kiara_9_dusk', 'kloetzle_blei', 'kloofendal_28d_misty', 'kloofendal_28d_misty_puresky', 'kloofendal_38d_partly_cloudy', 'kloofendal_38d_partly_cloudy_puresky', 'kloofendal_43d_clear', 'kloofendal_43d_clear_puresky', 'kloofendal_48d_partly_cloudy', 'kloofendal_48d_partly_cloudy_puresky', 'kloofendal_misty_morning', 'kloofendal_misty_morning_puresky', 'kloofendal_overcast', 'kloofendal_overcast_puresky', 'kloppenheim_01', 'kloppenheim_01_puresky', 'kloppenheim_02', 'kloppenheim_02_puresky', 'kloppenheim_03', 'kloppenheim_03_puresky', 'kloppenheim_04', 'kloppenheim_05', 'kloppenheim_05_puresky', 'kloppenheim_06', 'kloppenheim_06_puresky', 'kloppenheim_07', 'kloppenheim_07_puresky', 'lake_pier', 'lakes', 'learner_park', 'lenong_1', 'lenong_2', 'lenong_3', 'lilienstein', 'limpopo_golf_course', 'lonely_road_afternoon', 'lonely_road_afternoon_puresky', 'lot_01', 'mealie_road', 'misty_farm_road', 'moonless_golf', 'moonlit_golf', 'mpumalanga_veld', 'mpumalanga_veld_puresky', 'mud_road', 'mud_road_puresky', 'museumplein', 'noga', 'noon_grass', 'oberer_kuhberg', 'old_outdoor_theater', 'ostrich_road', 'overcast_soil', 'overcast_soil_2', 'overcast_soil_puresky', 'pizzo_pernice', 'pizzo_pernice_puresky', 'quarry_01', 'quarry_01_puresky', 'quarry_02', 'quarry_03', 'quarry_04', 'quarry_04_puresky', 'quarry_cloudy', 'qwantani', 'qwantani_puresky', 'railway_bridges', 'reichstag_1', 'resting_place', 'rocky_ridge', 'rocky_ridge_puresky', 'rolling_hills', 'rooftop_night', 'rooitou_park', 'rosendal_mountain_midmorning', 'rosendal_park_sunset', 'rosendal_park_sunset_puresky', 'round_platform', 'ruckenkreuz', 'rural_asphalt_road', 'rural_landscape', 'rural_winter_roadside', 'rustig_koppie', 'rustig_koppie_puresky', 'safari_sunset', 'sandsloot', 'satara_night', 'satara_night_no_lamps', 'scythian_tombs', 'scythian_tombs_2', 'scythian_tombs_puresky', 'shanghai_riverside', 'signal_hill_dawn', 'simons_town_rocks', 'skidpan', 'small_harbor_01', 'small_harbor_02', 'small_rural_road', 'snow_field', 'snow_field_2', 'snow_field_2_puresky', 'snow_field_puresky', 'snowy_field', 'spiaggia_di_mondello', 'spruit_dawn', 'spruit_sunrise', 'straw_rolls_field_01', 'sunflowers', 'sunflowers_puresky', 'sunset_fairway', 'sunset_in_the_chalk_quarry', 'syferfontein_0d_clear', 'syferfontein_0d_clear_puresky', 'syferfontein_18d_clear', 'syferfontein_18d_clear_puresky', 'syferfontein_1d_clear', 'syferfontein_1d_clear_puresky', 'syferfontein_6d_clear', 'syferfontein_6d_clear_puresky', 'symmetrical_garden', 'table_mountain_1', 'table_mountain_1_puresky', 'table_mountain_2', 'table_mountain_2_puresky', 'the_sky_is_on_fire', 'tiber_island', 'umhlanga_sunrise', 'veld_fire', 'venice_dawn_1', 'venice_sunset', 'versveldpas', 'wasteland_clouds', 'wasteland_clouds_puresky', 'waterbuck_trail', 'white_cliff_top', 'winter_lake_01', 'winter_river', 'winter_sky', 'yellow_field']